<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>iOS 开发之优雅的为视图同时添加圆角和阴影 | Genosage</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="在最近工作期间实现老板的一个需求时，我发现需要同时给一个控件添加圆角以及阴影效果。这本来是一个非常简单的功能，但在具体开发过程中，由于这个功能会重用很多次，自己的代码显得极其冗余且丑陋。在一个普通的下午，当我又一次在一个新的页面中实现这个功能时，我的强迫症彻底爆发，于是在经过了一个下午的学习（折腾）后，这篇总结文章诞生了。">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS 开发之优雅的为视图同时添加圆角和阴影">
<meta property="og:url" content="https://genosage.com/2017/05/17/iOS-开发之优雅的为视图同时添加圆角和阴影/index.html">
<meta property="og:site_name" content="Genosage">
<meta property="og:description" content="在最近工作期间实现老板的一个需求时，我发现需要同时给一个控件添加圆角以及阴影效果。这本来是一个非常简单的功能，但在具体开发过程中，由于这个功能会重用很多次，自己的代码显得极其冗余且丑陋。在一个普通的下午，当我又一次在一个新的页面中实现这个功能时，我的强迫症彻底爆发，于是在经过了一个下午的学习（折腾）后，这篇总结文章诞生了。">
<meta property="og:image" content="http://7xp0zm.com1.z0.glb.clouddn.com/WX20170517.png">
<meta property="og:image" content="http://7xp0zm.com1.z0.glb.clouddn.com/WX2017051701.png">
<meta property="og:image" content="http://7xp0zm.com1.z0.glb.clouddn.com/WX2017051702.png">
<meta property="og:image" content="http://7xp0zm.com1.z0.glb.clouddn.com/WX2017051703.png">
<meta property="og:image" content="http://7xp0zm.com1.z0.glb.clouddn.com/WX2017051704.png">
<meta property="og:updated_time" content="2017-05-17T13:28:01.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS 开发之优雅的为视图同时添加圆角和阴影">
<meta name="twitter:description" content="在最近工作期间实现老板的一个需求时，我发现需要同时给一个控件添加圆角以及阴影效果。这本来是一个非常简单的功能，但在具体开发过程中，由于这个功能会重用很多次，自己的代码显得极其冗余且丑陋。在一个普通的下午，当我又一次在一个新的页面中实现这个功能时，我的强迫症彻底爆发，于是在经过了一个下午的学习（折腾）后，这篇总结文章诞生了。">
  
    <link rel="alternative" href="/atom.xml" title="Genosage" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-71235863-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xp0zm.com1.z0.glb.clouddn.com/IMG_3193.PNG" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Tian Zhang</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Blogroll</li>
						
						
						<li>About</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/genosage" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/2395597413/profile?rightmod=1&wvr=6&mod=personinfo" title="weibo">weibo</a>
					        
								<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/zhangtian1104" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Algorithm/" style="font-size: 20px;">Algorithm</a> <a href="/tags/Array/" style="font-size: 10px;">Array</a> <a href="/tags/HashMap/" style="font-size: 10px;">HashMap</a> <a href="/tags/HashSet/" style="font-size: 10px;">HashSet</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Java/" style="font-size: 13.33px;">Java</a> <a href="/tags/Machine-Learning/" style="font-size: 16.67px;">Machine Learning</a> <a href="/tags/Personality/" style="font-size: 10px;">Personality</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/iOS/" style="font-size: 10px;">iOS</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cfdtlee.com/">cfdtlee</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://codingcai.github.io/">codingcai</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://johnnymao.com/">johnnymao</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://dirtymac.github.io/">dirtymac</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">Master of UniMelb, majoring in software engineering. Interested in coding, fitness, reading, cuisine. Contact me  zhangtian1104@gmail.com</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Tian Zhang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://7xp0zm.com1.z0.glb.clouddn.com/IMG_3193.PNG" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Tian Zhang</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/genosage" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/2395597413/profile?rightmod=1&wvr=6&mod=personinfo" title="weibo">weibo</a>
			        
						<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/zhangtian1104" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-iOS-开发之优雅的为视图同时添加圆角和阴影" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/17/iOS-开发之优雅的为视图同时添加圆角和阴影/" class="article-date">
  	<time datetime="2017-05-17T06:20:04.000Z" itemprop="datePublished">2017-05-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      iOS 开发之优雅的为视图同时添加圆角和阴影
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在最近工作期间实现老板的一个需求时，我发现需要同时给一个控件添加圆角以及阴影效果。这本来是一个非常简单的功能，但在具体开发过程中，由于这个功能会重用很多次，自己的代码显得极其冗余且丑陋。在一个普通的下午，当我又一次在一个新的页面中实现这个功能时，我的强迫症彻底爆发，于是在经过了一个下午的学习（折腾）后，这篇总结文章诞生了。<br><a id="more"></a></p>
<h2 id="u5706_u89D2_u6548_u679C"><a href="#u5706_u89D2_u6548_u679C" class="headerlink" title="圆角效果"></a>圆角效果</h2><p>想要给视图添加圆角效果，那么最常用的方法就是设置 <code>cornerRadius</code> 属性了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_<span class="built_in">test</span>View.layer.cornerRadius = <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<p>有关这个 <code>cornerRadius</code> 的解释，我们来看一看官方文档：</p>
<blockquote>
<p>Setting the radius to a value greater than 0.0 causes the layer to begin drawing rounded corners on its background. By default, the corner radius does not apply to the image in the layer’s contents property; it applies only to the background color and border of the layer. However, setting the masksToBounds property to YES causes the content to be clipped to the rounded corners.</p>
<p>The default value of this property is 0.0.</p>
</blockquote>
<p>文档中说，这个圆角效果不会应用到 <code>layer</code> 中 <code>contents</code> 属性中的图片上面，而只会应用到背景颜色以及边框上，这是什么意思呢？</p>
<p>我们知道， <code>CALayer</code> 中有一个类型为 <code>id</code> 的 <code>contents</code> 属性，这意味着我们可以将任意类型的对象赋值给它，应用是可以编译通过的。实际上，如果给 <code>contents</code> 赋的不是 <code>CGImage</code> 或者不赋值的话，这个图层会是空白的。所以说，当我们使用图层的方法让一个视图显示图片的时候，这个圆角效果是默认不会应用到图片上面的。</p>
<p>我们来做一个实验来试试看效果，添加一个 <code>UIView</code> 然后设置好它的圆角效果以及 <code>contents</code> 属性：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_testView.layer.cornerRadius = <span class="number">10</span>;</span><br><span class="line">_testView.layer.<span class="property">contents</span> = (__bridge <span class="property">id</span>)([UIImage imageNamed:@<span class="string">"cover_home"</span>].CGImage);</span><br></pre></td></tr></table></figure>
<p>然后我们运行程序：</p>
<p><img src="http://7xp0zm.com1.z0.glb.clouddn.com/WX20170517.png" alt=""></p>
<p>可以看到，我们明明设置好了圆角效果，但是图片的四角仍然是尖尖的！官方文档说的果然是对的！那么这种情况怎么办呢？文档中说了，通过设置 <code>masksToBounds</code> 属性的值为 <code>YES</code> ，就可以将图层的内容剪切成圆角的效果。</p>
<p>这个 <code>masksToBounds</code> 属性以及 <code>UIView</code> 中的 <code>clipToBounds</code> 属性效果很相似，具体它们都做了哪些事情等以后在总结。简单来说，这个 <code>masksToBounds</code> 会将任何超过图层边界的子图层的部分截取掉。也就是说我们在一个设置了圆角效果的视图上面添加一个大小相同的子视图，子视图的四个角会超过父视图的圆角边界并将其盖住，通过设置 <code>masksToBounds</code> 属性，子视图的四个角会被截掉从而也显示出圆角效果。</p>
<p>其实在实际开发中，使用这个 <code>masksToBounds</code> 实现圆角效果有一个坑，就是在图片非常多的情况下，界面会卡成狗。原因是这个属性导致了离屏渲染，带来很多额外的性能消耗，这个时候我们需要使用其他策略对圆角效果进行优化，这个。。。也等以后在总结吧。好像写跑题了，接下来还是继续写写添加阴影的效果。</p>
<h2 id="u9634_u5F71_u6548_u679C"><a href="#u9634_u5F71_u6548_u679C" class="headerlink" title="阴影效果"></a>阴影效果</h2><p>在 iOS 中给一个视图添加阴影效果也是非常简单的，我们只需要对 <code>layer</code> 的几个属性进行设置即可，那上文的例子来说，我们添加如下几行代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_testView.layer.shadowColor = [UIColor colorWithRed:<span class="number">0</span> green:<span class="number">0</span> blue:<span class="number">0</span> alpha:<span class="number">1</span>].CGColor;</span><br><span class="line">_testView.layer.shadowRadius = <span class="number">6</span>;</span><br><span class="line">_testView.layer.shadowOpacity = <span class="number">0.6</span>;</span><br><span class="line">_testView.layer.shadowOffset = CGSizeMake(<span class="number">6</span>, <span class="number">6</span>);</span><br></pre></td></tr></table></figure>
<p>然后运行：</p>
<p><img src="http://7xp0zm.com1.z0.glb.clouddn.com/WX2017051701.png" alt=""></p>
<p>阴影就设置好了！下面对代码中的几个属性一一进行详解：</p>
<ol>
<li><code>shadowColor</code> 可以设置阴影的颜色，默认的颜色是黑色。</li>
<li><code>shadowRadius</code> 可以设置阴影半径，默认值是 3，它会影响阴影的模糊程度。</li>
<li><code>shadowOpacity</code> 可以设置阴影的不透明度，默认值是 0，表示透明，如果这个属性赋值不在 <code>[0,1]</code> 的范围内会得到未定义的结果。</li>
<li><code>shadowOffset</code> 可以设置阴影的偏移值，以上面的代码为例，它表示向右偏移 6，向下偏移 6，默认值是 <code>(0, -3)</code> 。</li>
</ol>
<p>需要注意的一点是，在实际开发中，使用以上方法添加阴影效果有一个坑，因为，它，也可能会导致离屏渲染，而且如果没有事先确定阴影的形状，<code>CALayer</code> 在绘制阴影的时候需要递归遍历所有 <code>sublayer</code> 的 <code>alpha</code> 通道从而精确的计算出阴影的轮廓，这在一些情况下会带来极大的性能消耗。为了避免性能消耗，<code>CALayer</code> 中还有一个属性 <code>shadowPath</code> 可以设置阴影的路径或者说轮廓，这样 <code>CALayer</code> 在创建阴影时就可以直接使用这个路径了。但是这样也可能会有新的问题，因为这样设置的 <code>shadowPath</code> 并不会随视图大小位置的变化而变化。这一点等下一篇文章在总结吧，好像又偏题了。。。</p>
<h2 id="u540C_u65F6_u6DFB_u52A0_u4E24_u4E2A_u6548_u679C"><a href="#u540C_u65F6_u6DFB_u52A0_u4E24_u4E2A_u6548_u679C" class="headerlink" title="同时添加两个效果"></a>同时添加两个效果</h2><p>看了上文的描述，这两个效果是不是特别简单就可以实现呢，我们来试一试，将两个功能的代码都添加上：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">_testView.layer.cornerRadius = <span class="number">10</span>;</span><br><span class="line">_testView.layer.contents = (__bridge id)([UIImage imageNamed:@<span class="string">"cover_home"</span>].CGImage);</span><br><span class="line">_testView.layer.masksToBounds = YES;</span><br><span class="line">    </span><br><span class="line">_testView.layer.shadowColor = [UIColor colorWithRed:<span class="number">0</span> green:<span class="number">0</span> blue:<span class="number">0</span> alpha:<span class="number">1</span>].CGColor;</span><br><span class="line">_testView.layer.shadowRadius = <span class="number">6</span>;</span><br><span class="line">_testView.layer.shadowOpacity = <span class="number">0.6</span>;</span><br><span class="line">_testView.layer.shadowOffset = CGSizeMake(<span class="number">6</span>, <span class="number">6</span>);</span><br></pre></td></tr></table></figure>
<p>运行程序：</p>
<p><img src="http://7xp0zm.com1.z0.glb.clouddn.com/WX2017051702.png" alt=""></p>
<p>我们发现，阴影不见了！这是怎么回事呢？</p>
<p>其实罪魁祸首就是这个 <code>masksToBounds</code>，由于设置了这个属性，所有超出图层边界的东西都被裁剪掉了，而阴影也被这样裁掉了，这既是我们想要的，也是我们不想要的，此时怎么办呢？</p>
<p>解决办法就是，使用两个视图！这样的话，由父视图来显示阴影效果，子视图来对内容进行剪切，具体代码如下所示：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">_testView.layer.cornerRadius = <span class="number">10</span>;</span><br><span class="line">_testView.layer.shadowColor = [UIColor colorWithRed:<span class="number">0</span> green:<span class="number">0</span> blue:<span class="number">0</span> alpha:<span class="number">1</span>].CGColor;</span><br><span class="line">_testView.layer.shadowRadius = <span class="number">6</span>;</span><br><span class="line">_testView.layer.shadowOpacity = <span class="number">0.6</span>;</span><br><span class="line">_testView.layer.shadowOffset = CGSizeMake(<span class="number">6</span>, <span class="number">6</span>);</span><br><span class="line">    </span><br><span class="line">_contentView.layer.cornerRadius = <span class="number">10</span>;</span><br><span class="line">_contentView.layer.contents = (__bridge id)([UIImage imageNamed:@<span class="string">"cover_home"</span>].CGImage);</span><br><span class="line">_contentView.layer.masksToBounds = YES;</span><br></pre></td></tr></table></figure>
<p>运行程序：</p>
<p><img src="http://7xp0zm.com1.z0.glb.clouddn.com/WX2017051703.png" alt=""></p>
<p>大功告成！</p>
<h2 id="u521B_u5EFA_u53EF_u91CD_u7528_u7684_u4EE3_u7801_u6587_u4EF6"><a href="#u521B_u5EFA_u53EF_u91CD_u7528_u7684_u4EE3_u7801_u6587_u4EF6" class="headerlink" title="创建可重用的代码文件"></a>创建可重用的代码文件</h2><p>使用上文的方法可以同时添加圆角效果和阴影效果，然而，当需要多次实现这个功能时，代码会变得非常冗余，举个例子，如下图所示：</p>
<p><img src="http://7xp0zm.com1.z0.glb.clouddn.com/WX2017051704.png" alt=""></p>
<p>在这个页面中，如果对这四个视图分别添加这两个效果时，上面的代码将会重复写四次，很不高效。由于这四个视图只是内部视图不同，我们可以考虑让它们都继承自同一个类，然后在这个类中实现添加圆角和阴影的功能。这样子，我们只需要覆盖其 <code>addSubview</code>方法，就可以在实际开发过程中简单的使用啦。</p>
<p>下面贴出这个类的代码：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ZTCardView.h</span></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ZTCardView</span> : <span class="title">UIControl</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)initViews;</span><br><span class="line">- (<span class="keyword">void</span>)initConstraints;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIView</span> *)contentView;</span><br><span class="line">- (<span class="keyword">void</span>)setRadius:(<span class="built_in">CGFloat</span>)radius;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ZTCardView.m</span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"ZTCardView.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ZTCardView</span> ()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIView</span> *_contentView;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ZTCardView</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#pragma mark - init</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)initWithFrame:(<span class="built_in">CGRect</span>)frame</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:frame];</span><br><span class="line">    [<span class="keyword">self</span> initViews];</span><br><span class="line">    [<span class="keyword">self</span> initConstraints];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)coder</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithCoder:coder];</span><br><span class="line">    [<span class="keyword">self</span> initViews];</span><br><span class="line">    [<span class="keyword">self</span> initConstraints];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)initViews</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.backgroundColor</span> = <span class="built_in">UIColor</span><span class="variable">.whiteColor</span>;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.layer</span><span class="variable">.shadowColor</span> = [<span class="built_in">UIColor</span> colorWithRed:<span class="number">0</span> green:<span class="number">0</span> blue:<span class="number">0</span> alpha:<span class="number">1</span>]<span class="variable">.CGColor</span>;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.layer</span><span class="variable">.shadowOffset</span> = <span class="built_in">CGSizeMake</span>(<span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.layer</span><span class="variable">.shadowOpacity</span> = <span class="number">0.2</span>;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.layer</span><span class="variable">.shadowRadius</span> = <span class="number">4</span>;</span><br><span class="line">    </span><br><span class="line">    _contentView = [[<span class="built_in">UIView</span> alloc] init];</span><br><span class="line">    _contentView<span class="variable">.translatesAutoresizingMaskIntoConstraints</span> = <span class="literal">NO</span>;</span><br><span class="line">    _contentView<span class="variable">.userInteractionEnabled</span> = <span class="literal">NO</span>;</span><br><span class="line">    _contentView<span class="variable">.layer</span><span class="variable">.masksToBounds</span> = <span class="literal">YES</span>;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> setRadius:<span class="number">6</span>];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">super</span> addSubview:_contentView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)initConstraints</span><br><span class="line">&#123;</span><br><span class="line">    [_contentView<span class="variable">.leadingAnchor</span> constraintEqualToAnchor:<span class="keyword">self</span><span class="variable">.leadingAnchor</span>]<span class="variable">.active</span> = <span class="literal">YES</span>;</span><br><span class="line">    [_contentView<span class="variable">.trailingAnchor</span> constraintEqualToAnchor:<span class="keyword">self</span><span class="variable">.trailingAnchor</span>]<span class="variable">.active</span> = <span class="literal">YES</span>;</span><br><span class="line">    [_contentView<span class="variable">.topAnchor</span> constraintEqualToAnchor:<span class="keyword">self</span><span class="variable">.topAnchor</span>]<span class="variable">.active</span> = <span class="literal">YES</span>;</span><br><span class="line">    [_contentView<span class="variable">.bottomAnchor</span> constraintEqualToAnchor:<span class="keyword">self</span><span class="variable">.bottomAnchor</span>]<span class="variable">.active</span> = <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#pragma mark - functions</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Override to add views to content view</span></span><br><span class="line">- (<span class="keyword">void</span>)addSubview:(<span class="built_in">UIView</span> *)view</span><br><span class="line">&#123;</span><br><span class="line">    [_contentView addSubview:view];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#pragma mark - properties</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIView</span> *)contentView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _contentView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setRadius:(<span class="built_in">CGFloat</span>)radius</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.layer</span><span class="variable">.cornerRadius</span> = radius;</span><br><span class="line">    _contentView<span class="variable">.layer</span><span class="variable">.cornerRadius</span> = radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2016/01/18/分分钟学会一门语言之Python篇/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">分分钟学会一门语言之Python篇</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="iOS-开发之优雅的为视图同时添加圆角和阴影" data-title="iOS 开发之优雅的为视图同时添加圆角和阴影" data-url="https://genosage.com/2017/05/17/iOS-开发之优雅的为视图同时添加圆角和阴影/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"genosage"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Tian Zhang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-71235863-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>